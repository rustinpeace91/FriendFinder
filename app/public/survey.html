<!DOCTYPE html>
<html>
    <html lang="en-us">

        <head>
          <meta charset="UTF-8">
          <title>Friend Freak</title>
        
          <script
          src="https://code.jquery.com/jquery-3.3.1.js"
          integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
          crossorigin="anonymous"></script>
          <!-- Bootstrap -->
          <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
          <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
          <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
      
          <!-- Moment.js Reference -->


          <!-- <script src="http://momentjs.com/downloads/moment.js"></script>   -->
          <script src="https://cdn.jsdelivr.net/momentjs/2.12.0/moment.min.js"></script>

          <script type="text/javascript" src="comparelogic.js"></script>
      
        </head>
      
<body>
    <div class = "container">
        <div class="card">
            <form>
                <h5 class="card-header">Personality Survey</h5>

                <div class="card-body">
                        <p>type your name and a valid URL of a photo of yourself. Then answer the questions.</p>
                    <div class = "form-group">
                        <strong>Name:</strong>
                        <input type="text" class="form-control form-group" id="name" placeholder="Example input">
                        <strong>Photo URL:</strong>
                        <input type="text" class="form-control form-group" id="photo" placeholder="Example input">
                    </div>
                    <div class = "form-group">
                        <h3>Question 1</h3>
                        <strong class = "question">You enjoy meeting new people.</strong>
                        <select id = "question-1" class="custom-select form-group ">
                            <option data-index-number = "1">1 (Strongly Disagree)</option>
                            <option data-index-number = "2">2</option>
                            <option data-index-number = "3">3</option>
                            <option data-index-number = "4">4</option>
                            <option data-index-number = "5">5 (Strongly Agree)</option>
                        </select>
                    </div>
                    <div class = "form-group">
                            <h3>Question 2</h3>
                            <strong class = "question">Getting stuck in traffic is not a lot of fun for you</strong>
                            <select id = "question-2" class="custom-select form-group ">
                                <option data-index-number = "1">1 (Strongly Disagree)</option>
                                <option data-index-number = "2">2</option>
                                <option data-index-number = "3">3</option>
                                <option data-index-number = "4">4</option>
                                <option data-index-number = "5">5 (Strongly Agree)</option>
                            </select>
                    </div>
                    <div class = "form-group">
                            <h3>Question 3</h3>
                            <strong class = "question">You consider other peopleâ€™s feelings.</strong>
                            <select id = "question-3" class="custom-select form-group ">
                                <option data-index-number = "1">1 (Strongly Disagree)</option>
                                <option data-index-number = "2">2</option>
                                <option data-index-number = "3">3</option>
                                <option data-index-number = "4">4</option>
                                <option data-index-number = "5">5 (Strongly Agree)</option>
                            </select>
                    </div>
                    <div class = "form-group">
                            <h3>Question 4</h3>
                            <strong class = "question">Generally speaking, you don't know what you're doing. You're just kind of winging it</strong>
                            <select id = "question-4" class="custom-select form-group ">
                                <option data-index-number = "1">1 (Strongly Disagree)</option>
                                <option data-index-number = "2">2</option>
                                <option data-index-number = "3">3</option>
                                <option data-index-number = "4">4</option>
                                <option data-index-number = "5">5 (Strongly Agree)</option>
                            </select>
                    </div>
                    <div class = "form-group">
                            <h3>Question 5</h3>
                            <strong class = "question">Better to have the glass half full than half empty. If it's half empty you might as well pour it all out</strong>
                            <select id = "question-5" class="custom-select form-group ">
                                <option data-index-number = "1">1 (Strongly Disagree)</option>
                                <option data-index-number = "2">2</option>
                                <option data-index-number = "3">3</option>
                                <option data-index-number = "4">4</option>
                                <option data-index-number = "5">5 (Strongly Agree)</option>
                            </select>
                    </div>
                    <div class = "form-group">
                            <h3>Question 6</h3>
                            <strong class = "question">You have highly original ideas.</strong>
                            <select id = "question-6" class="custom-select form-group ">
                                <option data-index-number = "1">1 (Strongly Disagree)</option>
                                <option data-index-number = "2">2</option>
                                <option data-index-number = "3">3</option>
                                <option data-index-number = "4">4</option>
                                <option data-index-number = "5">5 (Strongly Agree)</option>
                            </select>
                    </div>
                    <div class = "form-group">
                            <h3>Question 7</h3>
                            <strong class = "question">You may say you're a dreamer, but you're not the only one</strong>
                            <select id = "question-7" class="custom-select form-group ">
                                <option data-index-number = "1">1 (Strongly Disagree)</option>
                                <option data-index-number = "2">2</option>
                                <option data-index-number = "3">3</option>
                                <option data-index-number = "4">4</option>
                                <option data-index-number = "5">5 (Strongly Agree)</option>
                            </select>
                    </div>
                    <div class = "form-group">
                            <h3>Question 8</h3>
                            <strong class = "question">You can tell imediatly whether you like someone by measuring the thickness of their eyebrows in millimeters</strong>
                            <select id = "question-8" class="custom-select form-group ">
                                <option data-index-number = "1">1 (Strongly Disagree)</option>
                                <option data-index-number = "2">2</option>
                                <option data-index-number = "3">3</option>
                                <option data-index-number = "4">4</option>
                                <option data-index-number = "5">5 (Strongly Agree)</option>
                            </select>
                    </div>
                    <div class = "form-group">
                            <h3>Question 9</h3>
                            <strong class = "question">Dumpster diving is a perfectly legitimate idea for a first date</strong>
                            <select id = "question-9" class="custom-select form-group ">
                                <option data-index-number = "1">1 (Strongly Disagree)</option>
                                <option data-index-number = "2">2</option>
                                <option data-index-number = "3">3</option>
                                <option data-index-number = "4">4</option>
                                <option data-index-number = "5">5 (Strongly Agree)</option>
                            </select>
                    </div>
                    <div class = "form-group">
                            <h3>Question 10</h3>
                            <strong class = "question">You consider yourself a go getter</strong>
                            <select id = "question-10" class="custom-select form-group ">
                                <option data-index-number = "1">1 (Strongly Disagree)</option>
                                <option data-index-number = "2">2</option>
                                <option data-index-number = "3">3</option>
                                <option data-index-number = "4">4</option>
                                <option data-index-number = "5">5 (Strongly Agree)</option>
                            </select>
                    </div>
                </form>
              <button type = "submit" id = "submit" class="btn btn-primary">Submit</a>
            </div>
          </div>
    </div>
    
    <!-- Modal -->
    <div class="modal fade" id="match" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLongTitle">Modal title</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            </div>
            <div id = "match-body" class="modal-body" style = "word-wrap: break-word;">
                ...
            </div>
            <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
        </div>
    </div>
</body>
<script type = "text/javascript">

    $("#submit").on("click", function(event) {
        event.preventDefault();

        var newFriend = {
            "name": "Jack",
            "photo": "google.com",
            "scores": []
        };

        if($("#name").val() === "" || $("photo").val() === ""){
            alert("please fill out all forms");
        } else {
            newFriend.name = $("#name").val().trim();
            newFriend.photo = $("#photo").val().trim();

            for(var i = 0; i < 10; i++){
                var questNum = i + 1;
                var answer = $("#question-" + questNum).find(':selected').data('index-number');
                newFriend.scores[i] = parseInt(answer);
            };
            
            var currentURL = window.location.origin;
            $.ajax({
                url: "/api/friends",
                type: "post",
                dataType: 'json',
                contentType: "application/json",
                data: JSON.stringify(newFriend)
            }).then(function(){

                alert("friend posted!!");

                for(var i = 0; i < 10; i++){
                    var questNum = i + 1;
                    $("#question-" + questNum).val("1 (Strongly Disagree)");
                };
                $.ajax({ url: currentURL + "/api/friends", method: "GET" }).then(function(friends){
                    //calls the closestFriend function to run the comparison logic, displays the values in a callback
                    closestFriend(newFriend, friends, function(match, percent){
                        var text = "<p>Closest Match Name: " + match.name + "</p>" +
                                    "<p>" + percent + "% Match</p>" +
                                    "<div><img src=" + match.photo + " style = 'width:90%;'></div>";

                        $("#match-body").html(text);
                        $("#match").modal("toggle");
                    });


                });

            })
        };

    });
</script>
</html>